
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test UsagiJS - Debug</title>
  <style>
    body {
      margin: 0;
      padding: 10px;
      font-family: Arial, sans-serif;
      background: #1a1a2e;
      color: white;
    }
    
    h1 {
      font-size: 20px;
      margin: 10px 0;
      color: #00ff88;
    }
    
    #debug {
      background: #16213e;
      border: 2px solid #0f3460;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      font-size: 12px;
      font-family: monospace;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .log {
      margin: 5px 0;
      padding: 5px;
      border-left: 3px solid #00ff88;
      background: rgba(0,255,136,0.1);
    }
    
    .error {
      border-left-color: #ff4444;
      background: rgba(255,68,68,0.1);
      color: #ff4444;
    }
    
    .success {
      border-left-color: #00ff88;
      background: rgba(0,255,136,0.2);
      color: #00ff88;
      font-weight: bold;
    }
    
    canvas {
      border: 2px solid #0f3460;
      border-radius: 8px;
      background: #000;
      image-rendering: pixelated;
      width: 100%;
      max-width: 480px;
    }
  </style>
</head>
<body>
  <h1>üê∞ Test UsagiJS - Debug</h1>
  
  <div id="debug">
    <div class="log">üì± Chargement...</div>
  </div>
  
  <canvas id="usagi-canvas"></canvas>

  <script>
    // Syst√®me de debug visuel
    function debugLog(message, type = 'log') {
      const debugDiv = document.getElementById('debug');
      const logDiv = document.createElement('div');
      logDiv.className = type;
      logDiv.textContent = message;
      debugDiv.appendChild(logDiv);
      debugDiv.scrollTop = debugDiv.scrollHeight;
    }

    // Intercepter les console.log
    const originalLog = console.log;
    console.log = function(...args) {
      debugLog(args.join(' '), 'log');
      originalLog.apply(console, args);
    };

    const originalError = console.error;
    console.error = function(...args) {
      debugLog('‚ùå ' + args.join(' '), 'error');
      originalError.apply(console, args);
    };

    debugLog('üîÑ Chargement de UsagiJS depuis GitHub...');
  </script>

  <!-- Charger UsagiJS depuis ton GitHub -->
  <script src="https://alex84010.github.io/usagi-js/usagi.js" 
          onload="debugLog('‚úÖ usagi.js charg√© !', 'success')"
          onerror="debugLog('‚ùå ERREUR: impossible de charger usagi.js', 'error')">
  </script>

  <script>
    debugLog('üéÆ Pr√©paration du code UsagiJS...');
    
    // Attendre un peu pour s'assurer que tout est charg√©
    setTimeout(() => {
      // V√©rifier si UsagiEngine existe
      if (typeof window.UsagiEngine !== 'undefined') {
        debugLog('‚úÖ UsagiEngine d√©tect√© !', 'success');
        debugLog('Canvas: ' + (window.UsagiEngine.canvas ? 'OK' : 'Non initialis√©'));
        debugLog('Taille tuile: ' + window.UsagiEngine.tileSize);
      } else {
        debugLog('‚ùå UsagiEngine NON d√©tect√© ! Le fichier usagi.js n\'est pas correctement charg√©.', 'error');
      }
      
      // V√©rifier si des scripts UsagiJS ont √©t√© trouv√©s
      const scripts = document.querySelectorAll('script[type="text/usagi"]');
      debugLog('Scripts UsagiJS trouv√©s: ' + scripts.length);
      
      // Apr√®s 3 secondes, v√©rifier les sprites
      setTimeout(() => {
        if (window.UsagiEngine && window.UsagiEngine.sprites) {
          const spriteCount = Object.keys(window.UsagiEngine.sprites).length;
          if (spriteCount > 0) {
            debugLog('‚úÖ Sprites charg√©s: ' + spriteCount, 'success');
            debugLog('Sprites: ' + Object.keys(window.UsagiEngine.sprites).join(', '));
            debugLog('‚úÖ‚úÖ‚úÖ TOUT FONCTIONNE ! Vous devriez voir le canvas ci-dessus ! ‚úÖ‚úÖ‚úÖ', 'success');
          } else {
            debugLog('‚ö†Ô∏è Aucun sprite charg√©. Les images ne sont peut-√™tre pas encore charg√©es...', 'error');
          }
        }
      }, 3000);
    }, 500);
  </script>

  <!-- Code UsagiJS de test -->
  <script type="text/usagi">
    taille_tuile = 32
    ground = ("https://placeholder.pics/svg/32x32/4CAF50/FFFFFF/grass".name="sol")
    "sol" = 10√ó8
    hero = ("https://placeholder.pics/svg/32x32/2196F3/FFFFFF/hero".name="heros".x=5.y=4)
  </script>

  <script>
    debugLog('üìù Code UsagiJS ajout√© √† la page');
  </script>
</body>
</html>
